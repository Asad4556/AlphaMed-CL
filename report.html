<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Patient Report - Alpha-Med Lab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
</head>
<body onload="loadReport()">
  <div class="report-container">
    <div class="report-header">
      <div class="qr-side">
        <canvas id="qr"></canvas>
      </div>
      <div class="center-lab-title">
        <h1>Alpha-Med Clinical Laboratory</h1>
        <p class="subtitle">Trusted Medical Diagnostics</p>
      </div>
      <div class="logo-side">
        <img src="logo.png" alt="Lab Logo" class="lab-logo" />
      </div>
    </div>

    <div class="patient-info">
      <p><strong>Name:</strong> <span id="name"></span></p>
      <p><strong>CNIC:</strong> <span id="cnic"></span></p>
      <p><strong>Phone:</strong> <span id="phone"></span></p>
      <p><strong>Age:</strong> <span id="age"></span></p>
      <p><strong>MRN:</strong> <span id="mrn"></span></p>
    </div>

    <div class="test-results">
      <h3>Test Results</h3>
      <table>
        <thead>
          <tr>
            <th>Test</th>
            <th>Result</th>
            <th>Normal Range</th>
            <th>Unit</th>
          </tr>
        </thead>
        <tbody id="test-body"></tbody>
      </table>
    </div>

    <div class="footer">
      <p>Generated on: <span id="date"></span></p>
      <p class="watermark">Alpha-Med Clinical Laboratory</p>
    </div>
  </div>

  <script>
    function loadReport() {
      const report = JSON.parse(localStorage.getItem("lastReport"));
      if (!report) return;

      document.getElementById("name").textContent = report.name;
      document.getElementById("cnic").textContent = report.cnic;
      document.getElementById("phone").textContent = report.phone;
      document.getElementById("age").textContent = report.age;
      document.getElementById("mrn").textContent = report.mrn;
      document.getElementById("date").textContent = new Date().toLocaleDateString();

      const tbody = document.getElementById("test-body");
      report.tests.forEach(test => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${test.name}</td>
          <td>${test.result}</td>
          <td>${test.normalRange}</td>
          <td>${test.unit || "-"}</td>
        `;
        tbody.appendChild(tr);
      });

      QRCode.toCanvas(document.getElementById("qr"), report.mrn, { width: 100 });
    }
  </script>
</body>
</html>
